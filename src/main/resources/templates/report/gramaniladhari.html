<!DOCTYPE html>
<html lang="en" >
<head data-th-replace="~{fragments/header :: headerFragment}" >
  <meta charset="UTF-8" >
  <title >Thymeleaf Springboot </title >
</head >
<body >
<nav data-th-replace="~{fragments/navBar :: navBarFragment}" ></nav >

<div class="container-fluid" >
  <div class="row text-center" >
    <div class="col" >
    </div >
    <div class="col" >
      <span class="font-weight-bold h2" >Gramaniladhari Report </span >
    </div >
    <div class="col" >
      <a class="btn btn-primary" data-th-href="${'/home'}" id="searchShow" tabindex="2" >
        <i class="fas fa-home" style="font-size: 20px" ></i >&nbsp;&nbsp;Home
      </a >
    </div >
  </div >
</div >

<div class="container-fluid text-center" >
  <!--data search form-->
  <div class="row" >
    <div class="container-fluid" >
      <form action="/report/gramaniladhari" method="POST" >
        <div class="row" >
          <div class="col" >
            <div class="form-row text-md-right text-sm-left" >
              <div class="col-md-4" >
                <label class="control-label" for="startDate" >From :</label >
              </div >
              <div class="col-md-8" >
                <input type="date" class="form-control " name="turnStartAt" id="startDate" required >
              </div >
            </div >
          </div >
          <div class="col" >
            <div class="form-row text-md-right text-sm-left" >
              <div class="col-md-4" >
                <label class="control-label" for="endDate" >To :</label >
              </div >
              <div class="col-md-8" >
                <input type="date" class="form-control " name="turnEndAt" id="endDate" required >
              </div >
            </div >
          </div >
        </div >
        <div class="row" >
          <div class="col" >
            <!--Gramaniladhari division-->
            <div class="form-row text-md-right text-sm-left" >
              <div class="col-md-4" >
                <label class="control-label" for="gramaNiladhari" >Gramaniladhari Division :</label >
              </div >
              <div class="col-md-8" >
                <input type="text" id="gramaNiladhari" class="form-control"
                       placeholder="Please enter gramaniladari division name" onkeyup="gramaniladhari(this)" />
                <input type="text" id="gramaNiladhariOne" readonly name="gramaNiladhari.name"
                       class="form-control" disabled value="" required >
                <div id="gramaNiladhari-box" ></div >
                <span class="form-text text-muted bg-warring" >Please type more than 3 character</span >
                <input name="gramaNiladhari.id" id="gramaNiladhariId" hidden value="" required >
              </div >
            </div >
          </div >
          <div class="col" >
            <div class="form-group" >
              <div class="col-md-4" >
                <label for="endDate" ></label >
              </div >
              <div class="col-md-8" >
                <button type="submit" class="btn btn-success" >
                  <i class="fa fa-search" aria-hidden="true" ></i >
                  &nbsp; &nbsp; Search
                </button >
              </div >
            </div >
          </div >
        </div >
      </form >
    </div >
  </div >
  <!--  data show-->
  <div class="row mt-3" data-th-fragment="{gramaniladhariReportDetail.gramaNiladhariFragment}" >
    <div class="container" >
      <div class="row" >
        <div class=" bg-primary container text-center" >
          <strong ><span data-th-text="${message}" ></span ></strong >
        </div >
      </div >
      <div class="row mt-3" data-th-if="${gramaniladhariReportDetail.gramaNiladhari != null}" >
        <div class="container-fluid" >
          <div class="row" >
            <div id="accordianId" role="tablist" aria-multiselectable="true" class="col-12" >
              <div class="card" >
                <div class="card-header" role="tab" id="section1HeaderId" >
                  <a data-toggle="collapse" data-parent="#accordianId" href="#section1ContentId" aria-expanded="true"
                     aria-controls="section1ContentId" class="container-fluid" >
                    <h3 class="text-center" >Gramaniladari Division </h3 >
                  </a >
                </div >
                <div id="section1ContentId" class="collapse in" role="tabpanel" aria-labelledby="section1HeaderId" >
                  <div class="card-body container" >
                    <!--Province-->
                    <div class="form-row text-center" >
                      <div class="col-md-4" >
                        <label class="form-label " > Province :</label >
                      </div >
                      <div class="col-md-8" >
                        <p class="display_detail"
                           data-th-text="${gramaniladhariReportDetail.gramaNiladhari.dsOffice.district.province.province}" ></p >
                      </div >
                    </div >
                    <!--District-->
                    <div class="form-row text-center" >
                      <div class="col-md-4" >
                        <label class="form-label " > District :</label >
                      </div >
                      <div class="col-md-8" >
                        <p class="display_detail"
                           data-th-text="${gramaniladhariReportDetail.gramaNiladhari.dsOffice.district.name}" ></p >
                      </div >
                    </div >
                    <!--AgOffice-->
                    <div class="form-row text-center" >
                      <div class="col-md-4" >
                        <label class="form-label " > Divisional Secretory
                                                     Office :</label >
                      </div >
                      <div class="col-md-8" >
                        <p class="display_detail"
                           data-th-text="${gramaniladhariReportDetail.gramaNiladhari.dsOffice.name}" ></p >
                      </div >
                    </div >
                    <!--Number-->
                    <div class="form-row text-center" >
                      <div class="col-md-4" >
                        <label class="form-label" > Number :</label >
                      </div >
                      <div class="col-md-8" >
                        <p class="display_detail"
                           data-th-text="${gramaniladhariReportDetail.gramaNiladhari.number}" ></p >
                      </div >
                    </div >
                    <!--GramaNiladhariDivision-->
                    <div class="form-row text-center" >
                      <div class="col-md-4" >
                        <label class="control-label" >Gramaniladhari Division :</label >
                      </div >
                      <div class="col-md-8" >
                        <p class="display_detail"
                           data-th-text="${gramaniladhariReportDetail.gramaNiladhari.name}" ></p >
                      </div >
                    </div >
                  </div >
                </div >
              </div >
            </div >
          </div >
          <!--summary report-->
          <div class="row" >
            <div class="container-fluid" >
              <div class="row" >
                <div class="col-6" >
                  <h3 >Summary Report</h3 >
                </div >
                <div class="col-6" >
                  <h3 > Graphical representation </h3 >
                </div >
              </div >
              <div class="row" >
                <div class="col-6" >
                  <table class="table table-striped table-inverse table-responsive" id="summaryReport" >
                    <thead class="thead-inverse" >
                    <tr >
                      <th >Index</th >
                      <th >Status Name</th >
                      <th >Patient Count</th >
                    </tr >
                    </thead >
                    <tbody >
                    <tr data-th-each="attributeAndCount, index : ${gramaniladhariReportDetail.attributeAndCounts}" >
                      <td data-th-text="${index.count}" ></td >
                      <td data-th-text="${attributeAndCount.name}" ></td >
                      <td data-th-text="${attributeAndCount.count}" ></td >
                    </tr >
                    </tbody >
                  </table >
                </div >
                <div class="col-6" >
                  <div class="row" >
                    <div class="col-md-1" ></div >
                    <div class="col-md-10" >
                      <div style="width:400px; height:100px;" >
                        <canvas id="myChart" width="400" height="100" ></canvas >
                      </div >
                    </div >
                    <div class="col-md-1" ></div >
                  </div >
                </div >
              </div >
            </div >
          </div >
        </div >
      </div >
    </div >
  </div >
</div >


<input data-th-value="${gramaNiladhariSearchUrl}" hidden id="gramaNiladhariSearchUrl" type="text" >
<!--footer fragment-->
<div data-th-replace="~{fragments/footer :: footerFragment}" ></div >
<!--script include-->
<div data-th-replace="~{fragments/script :: scriptFragment}" ></div >
<script type="text/javascript" src="/js/reportGramaniladhari.js" ></script >

<script >

    let STATUS = [];
    let PATIENT_COUNT = [];
    let COLORS = [];

    function showTableData() {
        let myTab = document.getElementById('summaryReport');
        for (let i = 1; i < myTab.rows.length; i++) {
            // GET THE CELLS COLLECTION OF THE CURRENT ROW.
            let objCells = myTab.rows.item(i).cells;
            STATUS.push(objCells.item(1).innerHTML);
            PATIENT_COUNT.push(parseInt(objCells.item(2).innerHTML));
            COLORS.push('#' + Math.floor(Math.random() * 16777215).toString(16));
        }
    }

    let canvas = document.getElementById("myChart");
    let ctx = canvas.getContext('2d');

    let data = {
        labels: STATUS,
        datasets: [
            {
                fill: true,
                backgroundColor: COLORS,
                data: PATIENT_COUNT,
// Notice the borderColor
                borderColor: ['black', 'black'],
                borderWidth: [2, 2]
            }
        ]
    };


    let options = {
        responsive: true,
        title: {
            display: true,
            text: 'Graphical representation summary data',
            position: 'top'
        },
        rotation: -0.7 * Math.PI
    };

    $(document).ready(function () {
        showTableData();
        // Chart declaration:
        let myBarChart = new Chart(ctx, {
            type: 'pie',
            data: data,
            options: options
        });
    });


</script >
</body >
</html >