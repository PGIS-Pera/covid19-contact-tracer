<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml" >
<head >
  <title >Covid19 Contact Tracer - App</title >

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css' />

  <!-- use the font -->
  <style >
      body {
          font-family: 'Roboto', sans-serif;
          font-size: 48px;
      }
  </style >
  <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" >

  <!-- fontawesome css -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" rel="stylesheet" >

</head >
<body >
<p th:text="${'Hello Dear ' + name}" ></p >
<div class="container-fluid" >
  <div class="container" >
    <p th:text="${'Hello Dear ' + name}" ></p >
    <p >This summary report is generated to according to record which entered by you</p >
  </div >
  <div class="container" >
    <div class="row" >
      <div class="container-fluid" >
        <div class="row" >
          <div class="col-6" >
            <h3 >Summary Report</h3 >
          </div >
          <div class="col-6" >
            <h3 > Graphical representation </h3 >
          </div >
        </div >
        <div class="row" >
          <div class="col-6" >
            <table class="table table-striped table-inverse table-responsive" id="summaryReport" >
              <thead class="thead-inverse" >
              <tr >
                <th >Index</th >
                <th >Status Name</th >
                <th >Record Count</th >
              </tr >
              </thead >
              <tbody >
              <tr th:each="attributeAndCount, index : ${userVsReportDetail.attributeAndCounts}" >
                <td th:text="${index.count}" ></td >
                <td th:text="${attributeAndCount.name}" ></td >
                <td th:text="${attributeAndCount.count}" ></td >
              </tr >
              </tbody >
            </table >
          </div >
          <div class="col-6" >
            <div class="row" >
              <div class="col-md-1" ></div >
              <div class="col-md-10" >
                <div style="width:400px; height:100px;" >
                  <canvas id="myChart" width="400" height="100" ></canvas >
                </div >
              </div >
              <div class="col-md-1" ></div >
            </div >
          </div >
        </div >
      </div >
    </div >
  </div >
  <div class="container" >
    Regards,
    <br />
    <em th:text="${sign}" ></em >
    <p th:text="${location}" ></p >
    <br />
    <p >Date : <span th:text="${#dates.format(#dates.createNow(), 'dd MMM yyyy HH:mm')}" ></span ></p >
  </div >
</div >
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" ></script >
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" ></script >
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" ></script >

<!-- Chart js-->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3/dist/chart.min.js" ></script >
<!-- fontawesome js -->
<script src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/js/fontawesome.min.js" ></script >

<script type="application/javascript" >

    let STATUS = [];
    let PATIENT_COUNT = [];
    let COLORS = [];

    function showTableData() {
        let myTab = document.getElementById('summaryReport');
        for (let i = 1; i < myTab.rows.length; i++) {
            // GET THE CELLS COLLECTION OF THE CURRENT ROW.
            let objCells = myTab.rows.item(i).cells;
            STATUS.push(objCells.item(1).innerHTML);
            PATIENT_COUNT.push(parseInt(objCells.item(2).innerHTML));
            COLORS.push('#' + Math.floor(Math.random() * 16777215).toString(16));
        }
    }

    let canvas = document.getElementById("myChart");
    let ctx = canvas.getContext('2d');

    let data = {
        labels: STATUS,
        datasets: [
            {
                fill: true,
                backgroundColor: COLORS,
                data: PATIENT_COUNT,
// Notice the borderColor
                borderColor: ['black', 'black'],
                borderWidth: [2, 2]
            }
        ]
    };


    let options = {
        responsive: true,
        title: {
            display: true,
            text: 'Graphical representation summary data',
            position: 'top'
        },
        rotation: -0.7 * Math.PI
    };

    $(document).ready(function () {

        showTableData();
        // Chart declaration:
        let myBarChart = new Chart(ctx, {
            type: 'pie',
            data: data,
            options: options
        });
    });

</script >
</body >
</html >


